function CellAutoCell(t,i){this.x=t,this.y=i,this.delays=[]}function CAWorld(t){this.width=24,this.height=24,this.options=t,this.wrap=!1,this.TOPLEFT={index:0,x:-1,y:-1},this.TOP={index:1,x:0,y:-1},this.TOPRIGHT={index:2,x:1,y:-1},this.LEFT={index:3,x:-1,y:0},this.RIGHT={index:4,x:1,y:0},this.BOTTOMLEFT={index:5,x:-1,y:1},this.BOTTOM={index:6,x:0,y:1},this.BOTTOMRIGHT={index:7,x:1,y:1},this.randomGenerator=Math.random;var r=[null,null,null,null,null,null,null,null],o=(this.options.hexTiles&&(r=[null,null,null,null,null,null]),this.step=function(){for(var t,i=0;i<this.height;i++)for(t=0;t<this.width;t++)this.grid[i][t].reset();for(i=this.height-1;0<=i;i--)for(t=this.width-1;0<=t;t--){this.fillNeighbors(r,t,i);var n=this.grid[i][t];n.process(r);for(var e=0;e<n.delays.length;e++)n.delays[e].steps--,n.delays[e].steps<=0&&(n.delays[e].action(n),n.delays.splice(e,1),e--)}},[{diffX:function(){return-1},diffY:function(){return-1}},{diffX:function(){return 0},diffY:function(){return-1}},{diffX:function(){return 1},diffY:function(){return-1}},{diffX:function(){return-1},diffY:function(){return 0}},{diffX:function(){return 1},diffY:function(){return 0}},{diffX:function(){return-1},diffY:function(){return 1}},{diffX:function(){return 0},diffY:function(){return 1}},{diffX:function(){return 1},diffY:function(){return 1}}]);if(this.options.hexTiles&&(o=this.options.flatTopped?[{diffX:function(){return-1},diffY:function(t){return t%2?-1:0}},{diffX:function(){return 0},diffY:function(){return-1}},{diffX:function(){return 1},diffY:function(t){return t%2?-1:0}},{diffX:function(){return 1},diffY:function(t){return t%2?0:1}},{diffX:function(){return 0},diffY:function(){return 1}},{diffX:function(){return-1},diffY:function(t){return t%2?0:1}}]:[{diffX:function(t,i){return i%2?0:-1},diffY:function(){return-1}},{diffX:function(t,i){return i%2?1:0},diffY:function(){return-1}},{diffX:function(){return-1},diffY:function(){return 0}},{diffX:function(){return 1},diffY:function(){return 0}},{diffX:function(t,i){return i%2?0:-1},diffY:function(){return 1}},{diffX:function(t,i){return i%2?1:0},diffY:function(){return 1}}]),this.fillNeighbors=function(t,i,n){for(var e=0;e<o.length;e++){var r=i+o[e].diffX(i,n),f=n+o[e].diffY(i,n);this.wrap&&(r=(r+this.width)%this.width,f=(f+this.height)%this.height),!this.wrap&&(r<0||f<0||r>=this.width||f>=this.height)?t[e]=null:t[e]=this.grid[f][r]}},this.initialize=function(t){t.sort(function(t,i){return t.distribution>i.distribution?1:-1});for(var i=0,n=0;n<t.length;n++)i+=t[n].distribution,t[n].distribution=i;this.grid=[];for(var e=0;e<this.height;e++){this.grid[e]=[];for(var r=0;r<this.width;r++)for(var f=100*this.randomGenerator(),n=0;n<t.length;n++)if(f<=t[n].distribution){this.grid[e][r]=new this.cellTypes[t[n].name](r,e);break}}},this.cellTypes={},this.registerCellType=function(t,e,r){if(this.cellTypes[t]=function(t,i){if(CellAutoCell.call(this,t,i),r&&r.call(this,t,i),e)for(var n in e)"function"!=typeof e[n]&&("object"==typeof e[n]?this[n]=JSON.parse(JSON.stringify(e[n])):this[n]=e[n])},this.cellTypes[t].prototype=Object.create(CellAutoCell.prototype),this.cellTypes[t].prototype.constructor=this.cellTypes[t],this.cellTypes[t].prototype.cellType=t,e)for(var i in e)"function"==typeof e[i]&&(this.cellTypes[t].prototype[i]=e[i])},t)for(var i in t)this[i]=t[i]}CellAutoCell.prototype.process=function(t){},CellAutoCell.prototype.countSurroundingCellsWithValue=function(t,i){for(var n=0,e=0;e<t.length;e++)null!==t[e]&&t[e][i]&&n++;return n},CellAutoCell.prototype.delay=function(t,i){this.delays.push({steps:t,action:i})},CellAutoCell.prototype.reset=function(t){},CellAutoCell.prototype.getSurroundingCellsAverageValue=function(t,i){for(var n=0,e=0;e<t.length;e++)null===t[e]||!t[e][i]&&0!==t[e][i]||(n+=t[e][i]);return n/t.length},CAWorld.prototype.initializeFromGrid=function(t,i){this.grid=[];for(var n=0;n<this.height;n++){this.grid[n]=[];for(var e=0;e<this.width;e++)for(var r=0;r<t.length;r++)if(t[r].gridValue===i[n][e]){this.grid[n][e]=new this.cellTypes[t[r].name](e,n);break}}},CAWorld.prototype.createGridFromValues=function(t,i){for(var n=[],e=0;e<this.height;e++){n[e]=[];for(var r=0;r<this.width;r++){n[e][r]=i;for(var f=this.grid[e][r],o=0;o<t.length;o++)f.cellType==t[o].cellType&&f[t[o].hasProperty]&&(n[e][r]=t[o].value)}}return n},function(){var t={World:CAWorld,Cell:CellAutoCell};"function"==typeof define&&define.amd?define("CellAuto",function(){return t}):"undefined"!=typeof module&&module.exports?module.exports=t:"undefined"!=typeof window?window.CellAuto=t:"undefined"!=typeof self&&(self.CellAuto=t)}();